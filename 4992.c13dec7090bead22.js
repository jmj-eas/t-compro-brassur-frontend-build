"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4992],{385:(R,O,i)=>{i.d(O,{l:()=>D});var b=i(5312),t=i(4438),s=i(2767),c=i(7343),v=i(177);const y=[[["","left",""]],[["","right",""]],"*"],e=["[left]","[right]","*"];function M(l,S){1&l&&t.nrm(0,"ion-back-button",10)}function P(l,S){1&l&&t.nrm(0,"ion-menu-button",11)}function I(l,S){if(1&l){const h=t.RV6();t.j41(0,"ion-button",12),t.bIt("click",function(){t.eBV(h);const f=t.XpG();return t.Njj(f.close())}),t.nrm(1,"ion-icon",13),t.k0s()}}function E(l,S){if(1&l&&(t.j41(0,"p"),t.EFF(1),t.k0s()),2&l){const h=t.XpG();t.R7$(),t.JRh(h.apiUrl)}}function T(l,S){1&l&&(t.j41(0,"ion-item",14)(1,"ion-label",15),t.EFF(2,"Off-Line"),t.k0s()())}let D=(()=>{class l{constructor(h,j){this.jmjModoConexionService=h,this.modalCtrl=j,this.menuType="back",this.apiUrl="",this.modo="prod"}ngOnInit(){this.apiUrl=b.c.apiUrl,this.modo=this.apiUrl.slice(-4)}close(){this.modalCtrl.dismiss(null)}static{this.\u0275fac=function(j){return new(j||l)(t.rXU(s.B),t.rXU(c.W3))}}static{this.\u0275cmp=t.VBU({type:l,selectors:[["app-header"]],inputs:{title:"title",menuType:"menuType"},ngContentSelectors:e,decls:14,vars:6,consts:[["no-border","","translucent",""],["color","success"],["slot","start"],["defaultHref","/",4,"ngIf"],["menu","appMenu",4,"ngIf"],[3,"click",4,"ngIf"],[1,"titulo"],[4,"ngIf"],["slot","end",1,"right-buttons"],["color","success","lines","none",4,"ngIf"],["defaultHref","/"],["menu","appMenu"],[3,"click"],["name","close","slot","icon-only"],["color","success","lines","none"],["color","danger"]],template:function(j,f){1&j&&(t.NAR(y),t.j41(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),t.DNE(3,M,1,0,"ion-back-button",3)(4,P,1,0,"ion-menu-button",4)(5,I,2,0,"ion-button",5),t.SdG(6),t.k0s(),t.j41(7,"ion-title",6),t.EFF(8),t.k0s(),t.DNE(9,E,2,1,"p",7),t.j41(10,"ion-buttons",8),t.DNE(11,T,3,0,"ion-item",9),t.SdG(12,1),t.k0s()(),t.SdG(13,2),t.k0s()),2&j&&(t.R7$(3),t.Y8G("ngIf","back"===f.menuType),t.R7$(),t.Y8G("ngIf","menu"===f.menuType),t.R7$(),t.Y8G("ngIf","modal"===f.menuType),t.R7$(3),t.JRh(f.title),t.R7$(),t.Y8G("ngIf","test"===f.modo),t.R7$(2),t.Y8G("ngIf",f.jmjModoConexionService.getModoOffLine()))},dependencies:[v.bT,c.Jm,c.QW,c.eU,c.iq,c.uz,c.he,c.MC,c.BC,c.ai,c.el],styles:[".titulo[_ngcontent-%COMP%]{color:#fff}ion-icon[_ngcontent-%COMP%]{color:#fff}.sc-ion-buttons-ios-h.ion-color.sc-ion-buttons-ios-s[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%], .ion-color[_ngcontent-%COMP%]   .sc-ion-buttons-ios-h.sc-ion-buttons-ios-s[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%], .sc-ion-buttons-md-h.ion-color.sc-ion-buttons-md-s[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%], .ion-color[_ngcontent-%COMP%]   .sc-ion-buttons-md-h.sc-ion-buttons-md-s[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{color:#fff}"]})}}return l})()},4992:(R,O,i)=>{i.r(O),i.d(O,{JmjHomePageModule:()=>U});var b=i(177),t=i(9417),s=i(7343),c=i(1050),v=i(467),y=i(5312),e=i(4438),M=i(2767),P=i(2130),I=i(5161),E=i(5032),T=i(1527),D=i(2226),l=i(3943),S=i(2464),h=i(385);function j(r,F){1&r&&e.nrm(0,"ion-spinner",18)}function f(r,F){if(1&r&&(e.j41(0,"p",7),e.EFF(1),e.nI1(2,"date"),e.k0s()),2&r){const o=e.XpG(2);e.R7$(),e.SpI("Fecha Apertura: ",e.i5U(2,1,o.fecha_apertura,"dd/MM/yyyy HH:mm"),"")}}function G(r,F){if(1&r&&(e.j41(0,"div")(1,"ion-row",7)(2,"ion-text")(3,"p",7),e.EFF(4),e.k0s(),e.DNE(5,f,3,4,"p",19),e.k0s()()()),2&r){const o=e.XpG();e.R7$(4),e.Lme("Habilitaci\xf3n: ",o.habilitacion," | Caja: ",o.caja,""),e.R7$(),e.Y8G("ngIf",o.fecha_apertura)}}function x(r,F){if(1&r&&(e.j41(0,"ion-item")(1,"ion-label",11)(2,"ion-text")(3,"ion-label",20),e.EFF(4,"Confirmacion Pend.:"),e.k0s()(),e.j41(5,"ion-text",21),e.EFF(6),e.nI1(7,"currency"),e.k0s()()()),2&r){const o=e.XpG();e.R7$(6),e.SpI("GS ",e.ii3(7,1,o.rendicionAConfirmar,"PYG","","1.0-0"),"")}}const A=[{path:"",component:(()=>{class r{constructor(o,n,a,d,u,p,g,m,_,C,J){this.jmjModoConexionService=o,this.apiSvc=n,this.loaderSvc=a,this.platform=d,this.alerSvc=u,this.route=p,this.toastController=g,this.router=m,this.jmjTomarDatosGlobales=_,this.jmjStorageService=C,this.authSvc=J,this.idUsuario="",this.habilitacion=0,this.caja=0,this.fecha_apertura=null,this.subscription=this.platform.backButton.subscribeWithPriority(9999,H=>{this.presentToast("No puede utilizar el boton de retroceso en esta vista")})}ngOnInit(){this.desEntidad=y.c.desentidad}ngOnDestroy(){this.subscription.unsubscribe()}ionViewWillEnter(){this.titulo=this.authSvc.getUserInfo().nombre,this.expira_en="Tu conexi\xf3n termina en "+this.authSvc.getUserInfo().expira_en_ms/1e3/60/60+" Hs",this.recuperarDatos()}presentToast(o){var n=this;return(0,v.A)(function*(){(yield n.toastController.create({message:o,duration:2e3})).present()})()}getIdpersonaFromToken(){try{const o=this.authSvc.getToken();return o&&JSON.parse(atob(o.split(".")[1])).idpersona||null}catch(o){return console.warn("No se pudo extraer idpersona del token:",o),null}}doRefresh(o){var n=this;return(0,v.A)(function*(){yield n.recuperarDatos(),o.target.complete(),setTimeout(()=>{o.target.complete()},2e3)})()}recuperarDatos(){var o=this;return(0,v.A)(function*(){let n=JSON.parse(yield o.jmjStorageService.getData(o.jmjStorageService.OFFLINE));o.billeteraGuardada=JSON.parse(yield o.jmjStorageService.getData(o.jmjStorageService.BILLETERA)),o.billeteraOnLine=JSON.parse(yield o.jmjStorageService.getData(o.jmjStorageService.BILLETERA_ONLINE));const a=yield o.jmjStorageService.getData("CAJA_DATA");if(a&&"undefined"!==a){const d=JSON.parse(a);o.habilitacion=d.habilitacion,o.caja=d.caja,o.fecha_apertura=d.fecha_apertura}if(o.transaccionesOffLine&&o.transaccionesOffLine.length>0&&(n=!0),n){let d=JSON.parse(yield o.jmjStorageService.getData(o.jmjStorageService.COMPRAS)),u=0;d&&d.length>0&&(u=d.reduce((_,C)=>Number(_)+(Number(C.precioUnitario)||0),0));let p=JSON.parse(yield o.jmjStorageService.getData(o.jmjStorageService.PRESTAMOS)),g=0;p&&p.length>0&&(g=p.reduce((_,C)=>Number(_)+(Number(C.monto)||0),0)),o.jmjModoConexionService.setModoOffLine(n);let m=JSON.parse(yield o.jmjStorageService.getData(o.jmjStorageService.BILLETERA));if(m.recibidos=m.ingresos,m.realizados=o.billeteraOnLine&&o.billeteraOnLine.egresos>0?o.billeteraOnLine.egresos+u+g:u+g,m.devoluciones=m.devoluciones,m.arendir=m.recibidos-m.realizados+m.devoluciones,m.rendicionAConfirmar=m.saldoPendiente,yield o.setDatosBilletera(m),o.cerrar)return void o.authSvc.logout()}if(!o.jmjModoConexionService.getModoOffLine()){yield o.loaderSvc.show("Cargando");const d=o.getIdpersonaFromToken();if(!d)return o.loaderSvc.stop(),void o.alerSvc.error("No se pudo obtener el idpersona del token");o.apiSvc.get("/valores/estadoCuenta/"+d).subscribe({next:(u=(0,v.A)(function*(p){o.loaderSvc.stop();const g=p;if(g){if(yield o.setDatosBilletera(g),o.cerrar)return void o.authSvc.logout()}else o.alerSvc.error("No se recibieron datos del estado de cuenta")}),function(g){return u.apply(this,arguments)}),error:u=>{o.loaderSvc.stop(),o.alerSvc.error("Error al obtener estado de cuenta: "+(u.error?.message||u.message||"Error desconocido")),console.error("Error al obtener estado de cuenta:",u)}})}var u})()}setDatosBilletera(o){var n=this;return(0,v.A)(function*(){if(!n.jmjModoConexionService.getModoOffLine()&&n.habilitacion&&n.caja&&o.talonario){if((n.habilitacion!==o.talonario.habilitacion||n.caja!==o.talonario.caja)&&(n.billeteraGuardada?.ingresos>0||n.billeteraGuardada?.saldo>0||n.billeteraGuardada?.saldoPendiente>0))return n.alerSvc.error("No puede utilizar la aplicaci\xf3n porque el usuario con la habilitaci\xf3n "+n.habilitacion+" y caja "+n.caja+" a\xfan no rindi\xf3 su caja o el proceso de recepci\xf3n est\xe1 pendiente"),void(n.cerrar=!0);n.cerrar=!1}n.valores_recibidos=parseFloat(o.recibidos)||0,n.pagos_realizados=parseFloat(o.realizados)||0,n.cobros_prestamos=parseFloat(o.devoluciones)||0,n.valores_a_rendir=parseFloat(o.arendir)||0,n.rendicionAConfirmar=parseFloat(o.rendicionAConfirmar)||0,n.iJmjBilletera={ingresos:n.valores_recibidos,egresos:n.pagos_realizados,devoluciones:n.cobros_prestamos,saldo:n.valores_a_rendir,saldoPendiente:n.rendicionAConfirmar},!n.jmjModoConexionService.getModoOffLine()&&o.talonario&&(n.habilitacion=o.talonario.habilitacion||0,n.caja=o.talonario.caja||0,n.fecha_apertura=o.fecha_apertura||null,n.jmjStorageService.saveData("CAJA_DATA",JSON.stringify({habilitacion:n.habilitacion,caja:n.caja,fecha_apertura:n.fecha_apertura}))),n.jmjTomarDatosGlobales.setBilletera(n.iJmjBilletera)})()}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(M.B),e.rXU(P.G),e.rXU(I.Z),e.rXU(E.OD),e.rXU(T.u),e.rXU(c.nX),e.rXU(s.K_),e.rXU(c.Ix),e.rXU(D.C),e.rXU(l.y),e.rXU(S.u))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-jmj-home"]],decls:39,vars:23,consts:[[3,"title","menuType"],[1,"ion-padding"],["slot","fixed",3,"ionRefresh"],["pullingIcon","chevron-down-circle-outline","pullingText","Pull to refresh","refreshingSpinner","circles","refreshingText","Refrescando..."],[1,"ion-text-center"],["name","dots",4,"ngIf"],[4,"ngIf"],[1,"ion-justify-content-center"],["sizeLg","5","sizeMd","6","sizeXl","4",1,"ion-align-self-center"],[1,"billetera"],["routerLink","/jmj-transferencia-valores/recibir"],[1,"ion-text-wrap"],[1,"concepto"],[1,"valor"],["name","arrow-forward-outline","slot","end"],["routerLink","/jmj-compra-hist/COMPRAS"],["name","arrow-forward-outline","slot","end",1,"iconos"],["routerLink","/jmj-transferencia-valores/enviar"],["name","dots"],["class","ion-justify-content-center",4,"ngIf"],["color","danger",1,"concepto"],["color","danger"]],template:function(n,a){1&n&&(e.nrm(0,"app-header",0),e.j41(1,"ion-content",1)(2,"ion-refresher",2),e.bIt("ionRefresh",function(u){return a.doRefresh(u)}),e.nrm(3,"ion-refresher-content",3),e.k0s(),e.j41(4,"div",4),e.DNE(5,j,1,0,"ion-spinner",5),e.k0s(),e.j41(6,"ion-grid"),e.DNE(7,G,6,3,"div",6),e.j41(8,"ion-row",7)(9,"ion-col",8)(10,"ion-list",9)(11,"ion-item",10)(12,"ion-label",11)(13,"ion-text")(14,"ion-label",12),e.EFF(15,"Valores Recibidos"),e.k0s()(),e.j41(16,"ion-text",13),e.EFF(17),e.nI1(18,"currency"),e.k0s()(),e.nrm(19,"ion-icon",14),e.k0s(),e.j41(20,"ion-item",15)(21,"ion-label",11)(22,"ion-text")(23,"ion-label",12),e.EFF(24,"Pagos Realizados"),e.k0s()(),e.j41(25,"ion-text",13),e.EFF(26),e.nI1(27,"currency"),e.k0s()(),e.nrm(28,"ion-icon",16),e.k0s(),e.j41(29,"ion-item",17)(30,"ion-label",11)(31,"ion-text")(32,"ion-label",12),e.EFF(33,"Valores a Rendir"),e.k0s()(),e.j41(34,"ion-text",13),e.EFF(35),e.nI1(36,"currency"),e.k0s()(),e.nrm(37,"ion-icon",14),e.k0s(),e.DNE(38,x,8,6,"ion-item",6),e.k0s()()()()()),2&n&&(e.FS9("title",a.titulo),e.Y8G("menuType","menu"),e.R7$(5),e.Y8G("ngIf",a.loading),e.R7$(2),e.Y8G("ngIf",a.habilitacion&&a.caja),e.R7$(10),e.SpI("GS ",e.ii3(18,8,a.valores_recibidos,"PYG","","1.0-0"),""),e.R7$(9),e.SpI("GS ",e.ii3(27,13,a.pagos_realizados,"PYG","","1.0-0"),""),e.R7$(9),e.SpI("GS ",e.ii3(36,18,a.valores_a_rendir,"PYG","","1.0-0"),""),e.R7$(3),e.Y8G("ngIf",a.rendicionAConfirmar&&0!==a.rendicionAConfirmar))},dependencies:[b.bT,s.hU,s.W9,s.lO,s.iq,s.uz,s.he,s.nf,s.To,s.Ki,s.ln,s.w2,s.IO,s.N7,c.Wk,h.l,b.oe,b.vh],styles:[".billetera[_ngcontent-%COMP%]{font-family:Verdana,Geneva,Tahoma,sans-serif}.concepto[_ngcontent-%COMP%]{font-size:20px;font-weight:700}.valor[_ngcontent-%COMP%]{color:gray}.conexion[_ngcontent-%COMP%]{font-size:10px}"]})}}return r})()}];let L=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=e.$C({type:r})}static{this.\u0275inj=e.G2t({imports:[c.iI.forChild(A),c.iI]})}}return r})();var N=i(9244);let U=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=e.$C({type:r})}static{this.\u0275inj=e.G2t({imports:[b.MD,t.YN,s.bv,L,N.Q]})}}return r})()}}]);